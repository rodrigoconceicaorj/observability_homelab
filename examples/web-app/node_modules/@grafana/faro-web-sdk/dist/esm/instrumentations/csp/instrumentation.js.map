{"version":3,"file":"instrumentation.js","sourceRoot":"","sources":["../../../../src/instrumentations/csp/instrumentation.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,mBAAmB,EAAE,qBAAqB,EAAE,OAAO,EAAE,MAAM,oBAAoB,CAAC;AAGzF,MAAM,OAAO,kBAAmB,SAAQ,mBAAmB;IAIzD;QACE,KAAK,EAAE,CAAC;QAJD,SAAI,GAAG,2CAA2C,CAAC;QACnD,YAAO,GAAG,OAAO,CAAC;IAI3B,CAAC;IAED,UAAU;QACR,QAAQ,CAAC,gBAAgB,CAAC,yBAAyB,EAAE,IAAI,CAAC,8BAA8B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvG,CAAC;IAED,OAAO;QACL,QAAQ,CAAC,mBAAmB,CAAC,yBAAyB,EAAE,IAAI,CAAC,8BAA8B,CAAC,CAAC;IAC/F,CAAC;IAEM,8BAA8B,CAAC,EAAgC;QACpE,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,yBAAyB,EAAE,qBAAqB,CAAC,EAAyB,CAAC,CAAC,CAAC;IAClG,CAAC;CACF","sourcesContent":["import { BaseInstrumentation, stringifyObjectValues, VERSION } from '@grafana/faro-core';\nimport type { Instrumentation } from '@grafana/faro-core';\n\nexport class CSPInstrumentation extends BaseInstrumentation implements Instrumentation {\n  readonly name = '@grafana/faro-web-sdk:instrumentation-csp';\n  readonly version = VERSION;\n\n  constructor() {\n    super();\n  }\n\n  initialize() {\n    document.addEventListener('securitypolicyviolation', this.securitypolicyviolationHandler.bind(this));\n  }\n\n  destroy() {\n    document.removeEventListener('securitypolicyviolation', this.securitypolicyviolationHandler);\n  }\n\n  public securitypolicyviolationHandler(ev: SecurityPolicyViolationEvent) {\n    this.api.pushEvent('securitypolicyviolation', stringifyObjectValues(ev as Record<string, any>));\n  }\n}\n"]}