{"version":3,"file":"instrumentation.js","sourceRoot":"","sources":["../../../../src/instrumentations/csp/instrumentation.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,gDAAyF;AAGzF;IAAwC,sCAAmB;IAIzD;QACE,YAAA,MAAK,WAAE,SAAC;QAJD,UAAI,GAAG,2CAA2C,CAAC;QACnD,aAAO,GAAG,mBAAO,CAAC;;IAI3B,CAAC;IAED,uCAAU,GAAV;QACE,QAAQ,CAAC,gBAAgB,CAAC,yBAAyB,EAAE,IAAI,CAAC,8BAA8B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvG,CAAC;IAED,oCAAO,GAAP;QACE,QAAQ,CAAC,mBAAmB,CAAC,yBAAyB,EAAE,IAAI,CAAC,8BAA8B,CAAC,CAAC;IAC/F,CAAC;IAEM,2DAA8B,GAArC,UAAsC,EAAgC;QACpE,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,yBAAyB,EAAE,IAAA,iCAAqB,EAAC,EAAyB,CAAC,CAAC,CAAC;IAClG,CAAC;IACH,yBAAC;AAAD,CAAC,AAnBD,CAAwC,+BAAmB,GAmB1D;AAnBY,gDAAkB","sourcesContent":["import { BaseInstrumentation, stringifyObjectValues, VERSION } from '@grafana/faro-core';\nimport type { Instrumentation } from '@grafana/faro-core';\n\nexport class CSPInstrumentation extends BaseInstrumentation implements Instrumentation {\n  readonly name = '@grafana/faro-web-sdk:instrumentation-csp';\n  readonly version = VERSION;\n\n  constructor() {\n    super();\n  }\n\n  initialize() {\n    document.addEventListener('securitypolicyviolation', this.securitypolicyviolationHandler.bind(this));\n  }\n\n  destroy() {\n    document.removeEventListener('securitypolicyviolation', this.securitypolicyviolationHandler);\n  }\n\n  public securitypolicyviolationHandler(ev: SecurityPolicyViolationEvent) {\n    this.api.pushEvent('securitypolicyviolation', stringifyObjectValues(ev as Record<string, any>));\n  }\n}\n"]}